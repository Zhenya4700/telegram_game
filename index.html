<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Telegram Stars</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #1a1e2c;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 16px;
        }
        
        .container {
            max-width: 400px;
            width: 100%;
            background: rgba(255,255,255,0.05);
            border-radius: 24px;
            padding: 24px;
            text-align: center;
        }
        
        h1 {
            color: #ffd966;
            font-size: 1.8rem;
            margin-bottom: 20px;
        }
        
        .balance {
            background: rgba(0,0,0,0.3);
            border-radius: 40px;
            padding: 12px 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: 1px solid rgba(255,215,0,0.3);
        }
        
        .star {
            font-size: 24px;
        }
        
        .amount {
            font-size: 24px;
            font-weight: bold;
            color: #ffd966;
        }
        
        .test-btn {
            background: linear-gradient(145deg, #ffd966, #e68a2e);
            color: #1a1e2c;
            border: none;
            padding: 16px 32px;
            border-radius: 40px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            border-bottom: 4px solid #b3540b;
            width: 100%;
            margin-bottom: 16px;
            transition: transform 0.1s;
        }
        
        .test-btn:active {
            transform: translateY(2px);
            border-bottom-width: 2px;
        }
        
        .message {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4caf50;
            border-radius: 16px;
            padding: 16px;
            margin-top: 20px;
            color: #4caf50;
            display: none;
        }
        
        .error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
            color: #f44336;
        }
        
        .status {
            margin-top: 20px;
            font-size: 14px;
            color: #8e94ab;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚≠êÔ∏è –¢–µ—Å—Ç Telegram Stars</h1>
        
        <!-- –ë–∞–ª–∞–Ω—Å –∑–≤–µ–∑–¥ -->
        <div class="balance">
            <span class="star">‚≠êÔ∏è</span>
            <span class="amount" id="starBalance">0</span>
            <span style="color: #8e94ab;">–∑–≤–µ–∑–¥</span>
        </div>
        
        <!-- –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ -->
        <button class="test-btn" id="testButton">
            üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å 1 –∑–≤–µ–∑–¥—É
        </button>
        
        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ -->
        <div class="message" id="successMessage">
            ‚úÖ –£—Ä–∞! –ó–≤–µ–∑–¥–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–µ—Å—Ç!
        </div>
        
        <!-- –°—Ç–∞—Ç—É—Å -->
        <div class="status" id="status">
            –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∑–≤–µ–∑–¥—É
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div style="margin-top: 20px; font-size: 12px; color: #666;">
            –≠—Ç–æ —Ç–µ—Å—Ç Telegram Stars. –ó–≤–µ–∑–¥—ã —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ! ‚≠êÔ∏è
        </div>
    </div>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã
        const testButton = document.getElementById('testButton');
        const starBalance = document.getElementById('starBalance');
        const successMessage = document.getElementById('successMessage');
        const statusEl = document.getElementById('status');
        
        // –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (–±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω)
        let stars = 0;
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        async function loadBalance() {
            try {
                // –¢—É—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞—à API –∑–∞–ø—Ä–æ—Å
                // –î–ª—è —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º 5 –∑–≤–µ–∑–¥
                stars = 5;
                starBalance.textContent = stars;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–ª–∞–Ω—Å–∞:', e);
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        function updateBalance(newStars) {
            stars = newStars;
            starBalance.textContent = stars;
        }
        
        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –∑–∞–ø—Ä–æ—Å 1 –∑–≤–µ–∑–¥—ã
        async function requestOneStar() {
            statusEl.textContent = '‚è≥ –û—Ç–∫—Ä—ã–≤–∞—é –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã...';
            
            // –°–æ–∑–¥–∞–µ–º –∏–Ω–≤–æ–π—Å –Ω–∞ 1 –∑–≤–µ–∑–¥—É
            // currency: 'XTR' - —ç—Ç–æ –∫–æ–¥ Telegram Stars
            // amount: 1 - —Ü–µ–Ω–∞ –≤ –∑–≤–µ–∑–¥–∞—Ö
            tg.openInvoice({
                currency: 'XTR',
                prices: [{ 
                    label: '–¢–µ—Å—Ç–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞', 
                    amount: 1  // 1 –∑–≤–µ–∑–¥–∞
                }]
            }, function(status) {
                // –≠—Ç–æ—Ç –∫–æ–ª–ª–±—ç–∫ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –æ–ø–ª–∞—Ç—ã
                console.log('–°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã:', status);
                
                if (status === 'paid') {
                    // –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!
                    statusEl.textContent = '‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞! –î–æ–±–∞–≤–ª—è—é –∑–≤–µ–∑–¥—É...';
                    
                    // –ò–º–∏—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥—ã (—Ç—É—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞—à API)
                    setTimeout(() => {
                        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –±–∞–ª–∞–Ω—Å –Ω–∞ 1
                        updateBalance(stars + 1);
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                        successMessage.style.display = 'block';
                        statusEl.textContent = '‚úÖ –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω! –ó–≤–µ–∑–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!';
                        
                        // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã —Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                        setTimeout(() => {
                            successMessage.style.display = 'none';
                        }, 3000);
                    }, 500);
                    
                } else if (status === 'cancelled') {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –æ–ø–ª–∞—Ç—É
                    statusEl.textContent = '‚ùå –û–ø–ª–∞—Ç–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞';
                    
                } else if (status === 'failed') {
                    // –û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã
                    statusEl.textContent = '‚ùå –û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã';
                }
            });
        }
        
        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å 1 –∑–≤–µ–∑–¥—É
        async function spendOneStar() {
            if (stars < 1) {
                statusEl.textContent = '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤–µ–∑–¥! –ö—É–ø–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞.';
                return;
            }
            
            statusEl.textContent = '‚è≥ –°–ø–∏—Å—ã–≤–∞—é –∑–≤–µ–∑–¥—É...';
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            setTimeout(() => {
                // –£–º–µ–Ω—å—à–∞–µ–º –±–∞–ª–∞–Ω—Å
                updateBalance(stars - 1);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                successMessage.textContent = '‚úÖ –ó–≤–µ–∑–¥–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!';
                successMessage.style.display = 'block';
                statusEl.textContent = '‚úÖ –ì–æ—Ç–æ–≤–æ! –û—Å—Ç–∞–ª–æ—Å—å –∑–≤–µ–∑–¥: ' + (stars - 1);
                
                setTimeout(() => {
                    successMessage.style.display = 'none';
                }, 3000);
            }, 500);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏
        testButton.addEventListener('click', () => {
            // –î–ª—è —Ç–µ—Å—Ç–∞: —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∑–≤–µ–∑–¥—É, –ø–æ—Ç–æ–º –¥–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ —Ç—Ä–∞—Ç—É
            if (confirm('–ó–∞–ø—Ä–æ—Å–∏—Ç—å 1 –∑–≤–µ–∑–¥—É —É Telegram?')) {
                requestOneStar();
            }
        });
        
        // –î–æ–±–∞–≤–∏–º –≤—Ç–æ—Ä—É—é —Ç–µ—Å—Ç–æ–≤—É—é –∫–Ω–æ–ø–∫—É
        const spendBtn = document.createElement('button');
        spendBtn.className = 'test-btn';
        spendBtn.style.background = 'linear-gradient(145deg, #ff6b6b, #ff4757)';
        spendBtn.textContent = 'üí∞ –ü–æ—Ç—Ä–∞—Ç–∏—Ç—å 1 –∑–≤–µ–∑–¥—É';
        spendBtn.addEventListener('click', spendOneStar);
        testButton.parentNode.insertBefore(spendBtn, testButton.nextSibling);
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadBalance();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        console.log('Telegram User:', tg.initDataUnsafe?.user);
        
    </script>
</body>
</html>
